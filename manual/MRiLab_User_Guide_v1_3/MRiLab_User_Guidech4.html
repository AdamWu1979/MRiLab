<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html> 
<head><title>4 Simulation</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="MRiLab_User_Guide.css" /> 
<script type="text/javascript" 
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <!--l. 821--><div class="crosslinks"><p class="noindent">[<a 
href="MRiLab_User_Guidech5.html" >next</a>] [<a 
href="MRiLab_User_Guidech3.html" >prev</a>] [<a 
href="MRiLab_User_Guidech3.html#tailMRiLab_User_Guidech3.html" >prev-tail</a>] [<a 
href="#tailMRiLab_User_Guidech4.html">tail</a>] [<a 
href="MRiLab_User_Guide3.html#MRiLab_User_Guidech4.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x9-370004"></a>Simulation</h2>
   <h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x9-380004.1"></a>Running Simulation</h3>
<!--l. 825--><p class="noindent" >The MRiLab converts simulation parameters from configuration files into temporary
configuration structures during loading process, and uses these structures
to organize simulation workflow. The user can check default value of each
parameter by placing mouse cursor over selected parameter. The use can modify
simulation parameters for desirable simulation design, <span 
class="cmbx-10">to make changes</span>
<span 
class="cmbx-10">effective, the user needs to press &#8216;Update&#8217; button located under</span>
<span 
class="cmbx-10">&#8216;Simulation Settings&#8217; panel. </span>The &#8216;Update&#8217; button not only updates these
structures, but also performs a series of pre-scan processes including checking
incompatibility error and initializing other necessary simulation variables.
<br 
class="newline" />
</p><!--l. 827--><p class="indent" >   On the left of &#8216;Update&#8217; button, there is a &#8216;Save&#8217; button which saves updated
configuration structure back into configuration files for later use. <span 
class="cmbx-10">One particular</span>
<span 
class="cmbx-10">case is that &#8216;CVs&#8217; need to be updated and saved in order to make changes</span>
<span 
class="cmbx-10">effective. </span>This is because &#8216;CVs&#8217; is one part of the sequence file which needs to be
interpreted at the sequence waveform generation module. The sequence memo is also
provided at the &#8216;PSD Memo&#8217; panel. It&#8217;s editable and can be saved using &#8216;Save&#8217;
button. <br 
class="newline" />
</p><!--l. 829--><p class="indent" >   On the right of &#8216;Update&#8217; button, there is a &#8216;Scan&#8217; button which activates sequence
waveform generation, actual scan process and post-scan process including
image reconstruction and data saving. The MRiLab automatically detects
parameter changes and set &#8216;Scan&#8217; button disabled. To enable &#8216;Scan&#8217; button,
simply press &#8216;Update&#8217; button. Notice that the update process may take some
time if heavy initialization is needed. The &#8216;Simulation Info Log&#8217; is helpful
for checking log information about each simulation step. Once simulation
setting gets configured properly, the user can press &#8216;Scan&#8217; button to start
scanning.<br 
class="newline" />
</p><!--l. 831--><p class="indent" >   In MRiLab v1.3, batch scan is also provided. Instead of performing scan right
after configuration, the user can choose to snapshot current configuration in batch
basket by pressing &#8216;basket&#8217; button on the right side of &#8216;Scan&#8217; button. To view queued
scans, the user can press &#8216;BatchSim&#8217; toolbar icon <br 
class="newline" />
</p>
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x9-380011"></a>


<!--l. 835--><p class="noindent" ><img 
src="Pictures/BatchSimPanelIcon.png" alt="pict"  
 />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4.1: </span><span  
class="content">BatchSim Toolbar Icon</span></div><!--tex4ht:label?: x9-380011 -->

   </div><hr class="endfigure" />
<!--l. 840--><p class="indent" >   The BatchSim panel (Figure <a 
href="#x9-380022">4.2<!--tex4ht:ref: fig:BatchSim --></a>) gives a list of queued scan tasks, the user can
move the order of these scans, delete queued scans and execute them all in one click.
The output folder is also adjustable.
</p>
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x9-380022"></a>


<!--l. 844--><p class="noindent" ><img 
src="Pictures/BatchSim.png" alt="pict"  
 />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4.2: </span><span  
class="content">A Preview of A BatchSim Panel. This panel shows a list of queued
scan tasks. </span></div><!--tex4ht:label?: x9-380022 -->

   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x9-390004.2"></a>Image and SNR</h3>
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x9-390013"></a>


<!--l. 854--><p class="noindent" ><img 
src="Pictures/SimulationImage.png" alt="pict"  
 />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4.3:  </span><span  
class="content">A  Preview  of  A  Simulated  Image.  The  preview  is  one  slice
of  simulated  image  using  gradient  echo  sequence  with  radial  readout  and
reconstructed without deapodization.</span></div><!--tex4ht:label?: x9-390013 -->

   </div><hr class="endfigure" />
<!--l. 859--><p class="indent" >   Figure <a 
href="#x9-390013">4.3<!--tex4ht:ref: fig:SimulationImage --></a> demonstrates an example of a series of simulation operated with
different sequences. Each sequence is labeled with an unique series number, and
shows in the list at &#8216;Scan Series&#8217; panel. This series number is also a reference id for
saved image and data in the output database (further explain in Chapter <a 
href="MRiLab_User_Guidech5.html#x10-400005">5<!--tex4ht:ref: chap:MRiLabToolboxes --></a>). There
is also a status label on the left of each sequence name. The status labels
include:
</p>
     <ul class="itemize1">
     <li class="itemize">Dx : parameter setting and sequence loading
     </li>
     <li class="itemize">... : scanning
     </li>
     <li class="itemize">B : queued scan in batch mode
     </li>
     <li class="itemize">V : scan complete successfully
     </li>
     <li class="itemize">X : scan incomplete or fail</li></ul>
<!--l. 869--><p class="indent" >   The example (Figure <a 
href="#x9-390013">4.3<!--tex4ht:ref: fig:SimulationImage --></a>) shows a series of successful simulation by using
PSD_GRE3D, PSD_GRE3DRadial and PSD_FIESTA3D sequences, as well as an
incomplete simulation using PSD_FIESTA3D at the second time. The preview axes
displays an image preview for series 2 simulated using PSD_GRE3DRadial sequence.
The user can switch previews for successful simulation by clicking scan series item.
Moreover, the series name is also editable. In this example the series name is kept the
same as sequence name, which is not absolutely necessary. If the multiple channel
coil for multiple receiving is performed (Figure <a 
href="#x9-390024">4.4<!--tex4ht:ref: fig:SimulationImage2 --></a>), the user can specify
display image to a single channel with &#8216;Channel #&#8217; pop-up menu, or choose
&#8216;SumofMagn&#8217; for summation of image magnitude of all channels or &#8216;SumofCplx&#8217; for
summation of complex image of all channels. If multiple echo is enabled in the
sequence, the user can also specify display image to any echo with &#8216;Echo
#&#8217; pop-up menu. Default value of 1 is used for single echo. The preview
image provides a quick overview of the simulated images, a further image
analysis can be performed with image display and analysis tools in Chapter
<a 
href="MRiLab_User_Guidech6.html#x11-1440006">6<!--tex4ht:ref: chap:ImageDisplayAndAnalysis --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x9-390024"></a>


<!--l. 873--><p class="noindent" ><img 
src="Pictures/SimulationImage2.png" alt="pict"  
 />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4.4: </span><span  
class="content">A Preview of A Simulated Image with Multiple Receiving. The
preview is one slice of simulated image using FIESTA sequence with 8 channel
head coil. The image is from the fifth coil channel.</span></div><!--tex4ht:label?: x9-390024 -->

   </div><hr class="endfigure" />
<!--l. 878--><p class="indent" >   At the bottom of the preview axes, there are information for the sequence name,
estimated remaining scan time in real time and a scan progress bar. A global relative
Signal-to-Noise Ratio (SNR) is also provided and automatic updated in real time.
The relative SNR is defined as the ratio of current SNR to the initial SNR calculated
upon loading the sequence. The SNR value is calculated using Equation
<a 
href="#x9-39003r1">4.1<!--tex4ht:ref: eq:SNR --></a>.
</p>
   <table class="equation"><tr><td> <a 
 id="x9-39003r1"></a>
<!--l. 880--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>S</mi><mi 
>N</mi><mi 
>R</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>B</mi><mn>0</mn><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>R</mi><mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>R</mi><mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>R</mi><mi 
>S</mi><mi 
>l</mi><mi 
>i</mi><mi 
>c</mi><mi 
>e</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mfrac><mrow 
><msqrt><mrow><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi> <mo 
class="MathClass-bin">&#x00D7;</mo> <mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi> <mo 
class="MathClass-bin">&#x00D7;</mo> <mi 
>S</mi><mi 
>l</mi><mi 
>i</mi><mi 
>c</mi><mi 
>e</mi><mi 
>N</mi><mi 
>u</mi><mi 
>m</mi> <mo 
class="MathClass-bin">&#x00D7;</mo> <mi 
>N</mi><mi 
>E</mi><mi 
>X</mi></mrow></msqrt></mrow>
          <mrow 
><mi 
>N</mi><mi 
>o</mi><mi 
>i</mi><mi 
>s</mi><mi 
>e</mi><mi 
>L</mi><mi 
>e</mi><mi 
>v</mi><mi 
>e</mi><mi 
>l</mi> <mo 
class="MathClass-bin">&#x00D7;</mo><msqrt><mrow><mi 
>B</mi><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>W</mi><mi 
>i</mi><mi 
>d</mi><mi 
>t</mi><mi 
>h</mi></mrow></msqrt></mrow></mfrac>
</math></td><td class="eq-no">(4.1)</td></tr></table>
<!--l. 885--><p class="indent" >   where
</p>
   <table class="equation"><tr><td> <a 
 id="x9-39004r2"></a>
<!--l. 887--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mtable 
class="aligned"><mtr 
><mtd columnalign="right" ><mi 
>R</mi><mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mi 
>F</mi><mi 
>O</mi><mi 
>V</mi> <mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi></mrow> 
 <mrow 
><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi></mrow></mfrac> <mo 
class="MathClass-punc">;</mo></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>R</mi><mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mi 
>F</mi><mi 
>O</mi><mi 
>V</mi> <mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi></mrow> 
 <mrow 
><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi></mrow></mfrac> <mo 
class="MathClass-punc">;</mo></mtd><mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>R</mi><mi 
>S</mi><mi 
>l</mi><mi 
>i</mi><mi 
>c</mi><mi 
>e</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>S</mi><mi 
>l</mi><mi 
>i</mi><mi 
>c</mi><mi 
>e</mi><mi 
>T</mi><mi 
>h</mi><mi 
>i</mi><mi 
>c</mi><mi 
>k</mi><mo 
class="MathClass-punc">.</mo></mtd>  <mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ></mtd>
   </mtr>                                                               </mtable>
</math></td><td class="eq-no">(4.2)</td></tr></table>
<!--l. 896--><p class="indent" >   To simulate image noise, MRiLab performs a noise adding process to acquired
<span 
class="cmti-10">k</span>-space data. The Gaussian noise with zero mean and user-defined standard
deviation is added to the complex signal. The standard deviation is determined using
Equation <a 
href="#x9-39005r3">4.3<!--tex4ht:ref: eq:Noise --></a>. If no noise is desired, the user can set &#8216;NoiseLevel&#8217; to zero to get
infinite SNR.

</p>
   <table class="equation"><tr><td> <a 
 id="x9-39005r3"></a>
<!--l. 898--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>N</mi><mi 
>o</mi><mi 
>i</mi><mi 
>s</mi><mi 
>e</mi> <mo 
class="MathClass-rel">=</mo>                                 <mfrac><mrow 
><mfrac><mrow 
><mi 
>N</mi><mi 
>o</mi><mi 
>i</mi><mi 
>s</mi><mi 
>e</mi><mi 
>L</mi><mi 
>e</mi><mi 
>v</mi><mi 
>e</mi><mi 
>l</mi></mrow> 
 <mrow 
><mi 
>N</mi><mi 
>o</mi><mi 
>i</mi><mi 
>s</mi><mi 
>e</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi></mrow></mfrac>  <mo 
class="MathClass-bin">&#x00D7;</mo><msqrt><mrow><mfrac><mrow 
><mi 
>B</mi><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>W</mi><mi 
>i</mi><mi 
>d</mi><mi 
>t</mi><mi 
>h</mi></mrow>
  <mrow 
><mi 
>B</mi><mi 
>W</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi></mrow></mfrac></mrow></msqrt>  </mrow> 
<mrow 
>   <mfrac><mrow 
><mi 
>B</mi><mn>0</mn></mrow>
<mrow 
><mi 
>B</mi><mn>0</mn><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi></mrow></mfrac> <mo 
class="MathClass-bin">&#x00D7;</mo><mfrac><mrow 
><mi 
>R</mi><mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>R</mi><mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>R</mi><mi 
>S</mi><mi 
>l</mi><mi 
>i</mi><mi 
>c</mi><mi 
>e</mi></mrow> 
         <mrow 
><mi 
>V</mi> <mi 
>o</mi><mi 
>l</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi></mrow></mfrac>           <mo 
class="MathClass-bin">&#x00D7;</mo><msqrt><mrow> <mfrac> <mrow 
> <mi 
>N</mi><mi 
>E</mi><mi 
>X</mi></mrow>
<mrow 
><mi 
>N</mi><mi 
>E</mi><mi 
>X</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi></mrow></mfrac> <mo 
class="MathClass-bin">&#x00D7;</mo><mfrac><mrow 
><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>F</mi><mi 
>r</mi><mi 
>e</mi><mi 
>q</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>P</mi><mi 
>h</mi><mi 
>a</mi><mi 
>s</mi><mi 
>e</mi><mo 
class="MathClass-bin">&#x00D7;</mo><mi 
>S</mi><mi 
>l</mi><mi 
>i</mi><mi 
>c</mi><mi 
>e</mi><mi 
>N</mi><mi 
>u</mi><mi 
>m</mi></mrow> 
             <mrow 
><mi 
>A</mi><mi 
>D</mi><mi 
>C</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi></mrow></mfrac></mrow></msqrt>             </mrow></mfrac>
</math></td><td class="eq-no">(4.3)</td></tr></table>
<!--l. 904--><p class="indent" >   where these reference values are given as:
</p>
   <table class="equation"><tr><td> <a 
 id="x9-39006r4"></a>
<!--l. 906--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mtable 
class="aligned"><mtr 
><mtd columnalign="right" ><mi 
>B</mi><mi 
>W</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mi 
>e</mi><mn>3</mn><mo 
class="MathClass-punc">;</mo></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>N</mi><mi 
>o</mi><mi 
>i</mi><mi 
>s</mi><mi 
>e</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">;</mo></mtd>  <mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>B</mi><mn>0</mn><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">;</mo></mtd>   <mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>V</mi> <mi 
>o</mi><mi 
>l</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mi 
>e</mi> <mo 
class="MathClass-bin">-</mo> <mn>9</mn><mo 
class="MathClass-punc">;</mo></mtd><mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>N</mi><mi 
>E</mi><mi 
>X</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">;</mo></mtd>  <mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ><mi 
>A</mi><mi 
>D</mi><mi 
>C</mi><mi 
>R</mi><mi 
>e</mi><mi 
>f</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mi 
>e</mi><mn>4</mn><mo 
class="MathClass-punc">.</mo></mtd> <mtd columnalign="left" ></mtd>
</mtr><mtr 
><mtd columnalign="right" ></mtd>
   </mtr>                                                               </mtable>
</math></td><td class="eq-no">(4.4)</td></tr></table>

   <!--l. 918--><div class="crosslinks"><p class="noindent">[<a 
href="MRiLab_User_Guidech5.html" >next</a>] [<a 
href="MRiLab_User_Guidech3.html" >prev</a>] [<a 
href="MRiLab_User_Guidech3.html#tailMRiLab_User_Guidech3.html" >prev-tail</a>] [<a 
href="MRiLab_User_Guidech4.html" >front</a>] [<a 
href="MRiLab_User_Guide3.html#MRiLab_User_Guidech4.html" >up</a>] </p></div>
<!--l. 918--><p class="indent" >   <a 
 id="tailMRiLab_User_Guidech4.html"></a>  </p> 
</body> 
</html>